<!DOCTYPE html>
<html>
<head>
    <title>Communication Dashboard</title>
</head>
<body>
    <h1>Submit Communication Details</h1>
    <form id="communication-form">
        <label for="MessageID">Message ID:</label>
        <input type="text" id="MessageID" name="MessageID" required><br>
        <label for="SenderDetails">Sender Details:</label>
        <input type="text" id="SenderDetails" name="SenderDetails"><br>
        <label for="RecipientDetails">Recipient Details:</label>
        <input type="text" id="RecipientDetails" name="RecipientDetails"><br>
        <label for="Date">Date:</label>
        <input type="datetime-local" id="Date" name="Date"><br>
        <label for="Medium">Medium:</label>
        <input type="text" id="Medium" name="Medium"><br>
        <label for="NumberOfAdults">Number of Adults:</label>
        <input type="number" id="NumberOfAdults" name="NumberOfAdults"><br>
        <label for="NumberOfChildren">Number of Children:</label>
        <input type="number" id="NumberOfChildren" name="NumberOfChildren"><br>
        <button type="submit">Submit</button>
    </form>

    <h2>Analytics</h2>
    <div id="analytics">
        <p>Total Messages: <span id="total-messages">0</span></p>
        <p>Average Number of Adults: <span id="avg-adults">0</span></p>
    </div>

    <script>
        document.getElementById('communication-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData.entries());

            const response = await fetch('/submit', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });

            if (response.ok) {
                alert('Data submitted successfully!');
                fetchAnalytics();
            } else {
                alert('Error submitting data!');
            }
        });

        async function fetchAnalytics() {
            const response = await fetch('/analytics');
            if (response.ok) {
                const data = await response.json();
                document.getElementById('total-messages').textContent = data.total_messages;
                document.getElementById('avg-adults').textContent = data.avg_adults;
            }
        }

        // Fetch analytics on page load
        fetchAnalytics();
    </script>
</body>
</html>
